<div align="center">
    <h1>📢 PlainCEETimer 用户手册</h1>
    <h4>适用于 v3.0.9 | 修订日期 2025/4/10</h4>
</div>

# 📖 目录
- [⬇️ 下载安装](#️-下载安装)
    * [🛠️ 运行环境准备](#-运行环境准备)
    * [🛠️ 下载安装程序](#-下载安装程序)
- [🎯 主窗口使用说明](#-主窗口使用说明)
    * [🎉 特性](#-特性)
    * [✨ 选项说明](#-选项说明)
- [🎯 托盘图标使用说明](#-托盘图标使用说明)
    * [🎉 特性](#-特性-1)
    * [✨ 选项说明](#-选项说明-1)
- [🎯 设置窗口使用说明](#-设置窗口使用说明)
    * [✨ 基本](#-基本)
    * [✨ 显示](#-显示)
    * [✨ 外观](#-外观)
    * [✨ 工具](#-工具)
- [🎯 关于窗口使用说明](#-关于窗口使用说明)
- [🎯 下载器窗口使用说明](#-下载器窗口使用说明)
    * [🎉 特性](#-特性-2)
    * [✨ 选项说明](#-选项说明-2)
- [🎯 考试信息管理器使用说明](#-考试信息管理器使用说明)
    * [🎉 特性](#-特性-3)
    * [✨ 选项说明](#-选项说明-3)
- [🎯 考试信息对话框使用说明](#-考试信息对话框使用说明)
- [🎯 规则管理器使用说明](#-规则管理器使用说明)
    * [🎉 特性](#-特性-4)
    * [✨ 选项说明](#-选项说明-4)
- [🎯 规则对话框使用说明](#-规则对话框使用说明)
    * [🎉 特性](#-特性-5)
    * [✨ 时间线说明](#-时间线说明)
    * [✨ 选项说明](#-选项说明-5)
- [🎯 全局自定义文本对话框使用说明](#-全局自定义文本对话框使用说明)
    * [✨ 选项说明](#-选项说明-6)
    * [✨ 占位符一览](#-占位符一览)
- [🎯 意外错误对话框使用说明](#-意外错误对话框使用说明)
- [🎯 命令行选项](#-命令行选项)
- [📄 致用户](#-致用户)

# ⬇️ 下载安装
## 🛠️ 运行环境准备
+ Windows 7 SP1 x64 及以上。
+ .NET Framework 4.8。新版 Windows 10/11 自带，其他版本系统需自行下载 ([点此](https://dotnet.microsoft.com/zh-cn/download/dotnet-framework/thank-you/net48-offline-installer)进入)，并且可能需要先安装相关系统更新及安全证书，请自行上网查询。

## 🛠️ 下载安装程序
+ 到 Release 页面下载 `PlainCEETimer_X.X_x64_Setup.exe`。[点此](https://github.com/WangHaonie/PlainCEETimer/releases/latest)进入。
+ 运行安装程序按提示进行。
+ 安装完成后会自动运行倒计时，位置默认在主显示器顶部居中。

# 🎯 主窗口使用说明
## 🎉 特性
+ 边框圆角设计：运行在 Windows 11 上则使用系统提供的专用 API 使圆角更加光滑。若其他版本系统则使用提供的传统 API 渲染圆角，会略带锯齿，但无伤大雅。
+ 防止使用常规方式关闭倒计时。
+ 对于 Windows 10 1903 及以上的系统，倒计时在首次运行时将跟随深/浅色主题使用黑/白底颜色组合，此特性会在用户点击一次设置的**保存**按钮后失效，之后将不再自动跟随。
+ 若系统安装了有 [`Noto Sans SC`](https://fonts.google.com/noto/specimen/Noto+Sans+SC)，则默认字体为 `Noto Sans SC` 而不是 `微软雅黑`，此特性会在用户点击一次设置的**保存**按钮后失效，之后将不再自动跟随。

## ✨ 选项说明

> [!TIP]
> 右键单击主窗口即可显示快捷菜单。

| **选项名称** | **功能说明** | **注意** |
| ----- | ---- | ---- |
| **切换** | 本程序支持多倒计时，此选项可以快捷切换到相应的考试进行显示。 |  |
| **设置** | 打开 设置 窗口来配置倒计时。 | 详见 [🎯 设置窗口使用说明](#-设置窗口使用说明)。 |
| **关于** | 打开 关于 窗口查看有关本程序的信息以及一些有用的链接。 | 详见 [🎯 关于窗口使用说明](#-关于窗口使用说明)。 |
| **安装目录** | 打开本程序的安装文件夹。 |  |

# 🎯 托盘图标使用说明
## 🎉 特性
+ 当鼠标悬停在图标上时，可显示当前倒计时的内容。(默认关闭，需手动开启。)
+ 直接左键单击托盘图标可实现右键菜单 **显示界面** 选项同样的效果。

## ✨ 选项说明

> [!TIP]
> 右键单击托盘图标即可显示快捷菜单。

| **选项名称** | **功能说明** | **注意** |
| ----- | ---- | ---- |
| **设置** | 打开 设置 窗口来配置倒计时。 | 详见 [🎯 设置窗口使用说明](#-设置窗口使用说明)。 |
| **关于** | 打开 关于 窗口查看有关本程序的信息以及一些有用的链接。 | 详见 [🎯 关于窗口使用说明](#-关于窗口使用说明)。 |
| **安装目录** | 打开本程序的安装文件夹。 |  |
| **显示界面** | 点击后将显示本程序已打开的窗口。 |  |
| **关闭** | 可在此快速 **重启/退出** 倒计时 | 在 **设置>工具** 里也有相应功能。 |

# 🎯 设置窗口使用说明
## ✨ 基本
| **选项名称** | **功能说明** | **注意** |
| ----- | ---- | ---- |
| **管理** | 用于存储并管理考试信息以支持多倒计时功能。 | 详见 [🎯 考试信息管理器使用说明](#-考试信息管理器使用说明)。 |
| **启用自动切换** | 当存在2个及以上的考试信息时，可启用自动切换功能轮流对各考试进行倒计时。切换间隔可在旁边的下拉菜单中选择。 |  |
| **系统运行时自动启动倒计时** | 设置倒计时开机启动。 |  |
| **自动清理倒计时占用的运行内存** | 开启后，将每隔5分钟清理倒计时运行内存占用。 |  |
| **顶置倒计时窗口** | 是否顶置倒计时窗口。 |  |
| **顶置其他窗口** | 是否顶置本程序除倒计时窗口以外的窗口，比如 设置、关于、对话框 等。 | 只有勾选了 **顶置倒计时窗口** 才能更改此选项。 |
| **在托盘区域显示通知图标** | 是否在任务栏托盘区域显示程序图标。 |  |
| **鼠标悬停在通知图标上时显示倒计时内容** | 开启后，并且倒计时正常进行，将在托盘图标的描述文本中实时显示倒计时内容。 |  |
| **使用 Windows 经典右键菜单样式** | 开启后本程序的所有快捷菜单 (右键菜单) 的样式将为系统经典样式。 | ~~众所周知 .NET 默认的右键菜单样式不是一般的丑。~~ |

## ✨ 显示
| **选项名称** | **功能说明** | **注意** |
| ----- | ---- | ---- |
| **当考试开始后, 显示...** | 可选显示 **考试还有多久结束** 以及 **考试已经过去了多久** | 本程序的~~特色功能，或许没用~~。因为在开发时想到当考试开始后倒计时似乎就没有什么可以显示的了，显得有些单调，所以添加了该功能。 |
| **只显示...** | 可选是否只显示**天/时/分/秒**等 | 与 **自定义不同时刻的颜色和内容** 选项冲突，二者只能开启之一 |
| **不足一天按整天计算** | 用于达到纸质倒计时的效果，开启后倒计时会将不足一天的时间按整天计算 | 只有当 **只显示...** 设置为 **天** 的时候才能更改此选项。 |
| **自定义不同时刻的颜色和内容** + **规则管理器** | 高度自定义各个不同时刻倒计时要显示的内容格式、颜色等。比如还有100天时显示为紫色。 | 详见 [🎯 规则管理器使用说明](#-规则管理器使用说明)。与 **只显示...** 选项冲突，二者只能开启之一。 |
| **固定在屏幕...位置...** | 用于将倒计时窗口固定在指定屏幕的9个特殊位置。 | 与 **允许拖动倒计时窗口** 选项冲突，二者只能开启之一。 |
| **允许拖动倒计时窗口** | 开启后可以随心所欲的拖动倒计时窗口 | 与 **固定在屏幕...位置...** 选项冲突，二者只能开启之一。 |
| **兼容希沃PPT小工具** | 用于解决希沃PPT小工具内置白板打开后底部工具栏消失的情况。 | 仅个别机型存在该问题且只有倒计时恰好在左上角且顶置才会出现。 |

## ✨ 外观
| **选项名称** | **功能说明** | **注意** |
| ----- | ---- | ---- |
| **字体和大小** | 更改倒计时字体和大小 以及 恢复默认字体和大小。 | 字体推荐使用 `微软雅黑` 或 [`Noto Sans SC`](https://fonts.google.com/noto/specimen/Noto+Sans+SC)，大小为 `10`~`36`pt。恢复默认时若系统安装了有 [`Noto Sans SC`](https://fonts.google.com/noto/specimen/Noto+Sans+SC) 则将其作为默认字体。 |
| **字体颜色** | 直接点击相应色块来选择文字、背景颜色 以及 恢复默认颜色组合，并可选黑底或白底。 | 将一个色块拖放到其它色块上可快速应用相同的颜色。若启用了`自定义不同时刻的颜色和内容`，此处的颜色将用于匹配规则之外作为全局默认颜色。 |

## ✨ 工具
| **选项名称** | **功能说明** | **注意** |
| ----- | ---- | ---- |
| **同步网络时钟** | 选择现有的 NTP 服务器然后与之同步时钟。 | 将设置为系统默认 NTP 服务器且自动启动 Windows Time 服务。需要**管理员权限**，若无将弹出授权提示。 |
| **重启倒计时** | 主要用于更改了屏幕缩放之后, 可以点击此按钮来重启程序以确保 UI 正常显示。 | 由于无法支持 `Per-Monitor V2`，需手动重启才能避免模糊。右键单击按钮有惊喜。 |
| **应用主题设置** | 用于更改除倒计时窗口以外的 UI 界面主题。可选 跟随系统/浅色/深色。 | 深色主题目前覆盖率 95%。仅支持 Windows 10 1903 及以上并且关闭了系统高对比度主题。 |

# 🎯 关于窗口使用说明
| **选项名称** | **功能说明** | **注意** |
| ----- | ---- | ---- |
| **程序 Logo** | 手动检查更新。 | 检查更新功能为强制启用机制，无法控制其开关。 |
| **链接** | 点击相应链接跳转到相应的页面。 |  |

# 🎯 下载器窗口使用说明

> [!TIP]
> 用于下载更新程序。打开途径：有更新时用于确认后会弹出下载器窗口；使用命令行参数 `/fr` 强行运行下载器 (详见 [🎯 命令行选项](#-命令行选项))。

## 🎉 特性
+ 除了在界面中显示实时下载进度/大小/速度等之外，在任务栏图标上也会显示进度条。

## ✨ 选项说明
| **选项名称** | **功能说明** | **注意** |
| ----- | ---- | ---- |
| **浏览器下载** | 跳转到浏览器并使用浏览器手动下载安装程序。 |  |
| **重试** | 下载出错时可以重新启动下载。 |  |

# 🎯 考试信息管理器使用说明

> [!TIP]
> 通过 `设置>基本: 管理` 打开。

> [!IMPORTANT]
> 有关**考试信息对话框**的使用，请见 [🎯 考试信息对话框使用说明](#-考试信息对话框使用说明)。

## 🎉 特性
+ 自动排序功能：只按考试的**开始时间**进行降序 (近到远) 排列。不允许用户自定义顺序。
+ **编辑**：**左键双击**现有考试信息可快速打开考试信息对话框。
+ **删除**：按下 `Delete` 键即可实现删除。
+ **全选**：按下 `Ctrl`+`A` 组合键即可实现全选。支持不连续多选 (**原生特性**，按住 `Ctrl` 同时 `鼠标左键` 单击考试信息)。

## ✨ 选项说明
| **选项名称** | **功能说明** | **注意** |
| ----- | ---- | ---- |
| **表格 (`ListView`)** | 展示存储的考试信息。 | 右键单击表格打开快捷菜单进行相关操作。 |
| **操作** | 在当前位置显示表格的快捷菜单。 | 适用于无法右键单击表格打开菜单的特殊情况，而左键单击此按钮就可以显示菜单。 |
| **添加** | 添加新的考试信息。 | 详见 [🎯 考试信息对话框使用说明](#-考试信息对话框使用说明)。 |
| **编辑** | 编辑当前选中的考试信息。 | 只能选中一个，不能同时编辑多个考试信息。详见 [🎯 考试信息对话框使用说明](#-考试信息对话框使用说明)。 |
| **删除** | 删除当前选中的考试信息。 | 支持多选。 |
| **全选** | 全选所有的考试信息。 |  |

# 🎯 考试信息对话框使用说明

> [!TIP]
> 日期时间挑选器使用说明
> + 如何设置日期？
>   + 【**方法一**】点击右侧日历图标，展开后可在日历中选择。
>   + 【**方法二**】直接点击控件里的数字 (对应 年月日)，然后输入即可。上下箭头可以进行自增/减，左右箭头切换输入区域。比如要设置 `2025年6月7日`，先点击年对应的数字，输入 `2025` 后按下右箭头输入 `6`，然后按下右箭头输入 `7` 即可。
> + 如何设置时间？
>   + 同上述设置日期的**方法二**。

| **选项名称** | **功能说明** | **注意** |
| ----- | ---- | ---- |
| **考试名称** | 输入考试的名称。 | `2`~`10`字。 |
| **开始日期和时间** | 选择/输入考试的开始日期和时间。 | 方法详见上方 Tip |
| **结束日期和时间** | 选择/输入考试的结束日期和时间。 | 方法详见上方 Tip |

# 🎯 规则管理器使用说明

> [!TIP]
> 通过 `设置>显示: 勾选 "自定义不同时刻的颜色和内容" 后点击 "规则管理器"` 打开。

> [!IMPORTANT]
> 有关**规则对话框**的使用，请见 [🎯 规则对话框使用说明](#-规则对话框使用说明)。
> 有关**全局自定义文本对话框**的使用，请见 [🎯 全局自定义文本对话框使用说明](#-全局自定义文本对话框使用说明)。

## 🎉 特性
+ 自动排序功能：先按规则**类别**排序，再按**时刻**升序 (远到近) 排列。如果规则**类别**为第三阶段，则按**时刻**降序排列 (近到远)。不允许用户自定义顺序。
+ **编辑**：**左键双击**现有规则可快速打开规则对话框。
+ **删除**：按下 `Delete` 键即可实现删除。
+ **全选**：按下 `Ctrl`+`A` 组合键即可实现全选。支持不连续多选 (**原生特性**，按住 `Ctrl` 同时 `鼠标左键` 单击规则)。

## ✨ 选项说明
| **选项名称** | **功能说明** | **注意** |
| ----- | ---- | ---- |
| **表格 (`ListView`)** | 展示存储的规则。 | 右键单击表格打开快捷菜单进行相关操作。 |
| **操作** | 在当前位置显示表格的快捷菜单。 | 适用于无法右键单击表格打开菜单的特殊情况，而左键单击此按钮就可以显示菜单。 |
| **添加** | 添加新的规则。 | 详见 [🎯 规则对话框使用说明](#-规则对话框使用说明)。 |
| **编辑** | 编辑当前选中的规则。 | 只能选中一个，不能同时编辑多个规则。详见 [🎯 规则对话框使用说明](#-规则对话框使用说明)。 |
| **删除** | 删除当前选中的规则。 | 支持多选。 |
| **全选** | 全选所有的规则。 |  |
| **全局设置** | 打开**全局自定义文本对话框**，用于存放规则之外的倒计时要显示的内容。 | 详见 [🎯 全局自定义文本对话框使用说明](#-全局自定义文本对话框使用说明)。 |

# 🎯 规则对话框使用说明
## 🎉 特性
+ 在**添加**模式下，对话框会缓存用户临时设置的三个阶段 (详见 [✨ 时间线说明](#-时间线说明)) 的相关信息以便翻阅。

## ✨ 时间线说明
以下简易图表表示了本程序各场景对于一场考试三个阶段的描述性文本。
```
    未开始                已开始                 已结束      // 全局自定义文本对话框
  距离开始还有           距离结束还有           距离已过去了   // 规则对话框的下拉列表
    考试前                考试中                 考试后      // 规则管理器的 类型 栏目
-------------->考试开始-------------->考试结束------------->
    第一阶段              第二阶段               第三阶段     // 可以分为三个阶段
```

## ✨ 选项说明
| **选项名称** | **功能说明** | **注意** |
| ----- | ---- | ---- |
| **当距离考试...** | 选择规则要匹配的阶段。 | 有关各阶段，详见 [✨ 时间线说明](#-时间线说明)。 |
| **...天...时...分...秒** | 在指定的时间匹配该规则。 | 最少`1`秒，不能全为`0`。可以通过键盘上下箭头来对值进行自增/减。 |
| **文字颜色为...背景颜色为...** | 指定在此时要显示的文字/背景颜色。 | 点击色块选择颜色，不支持像**设置**里那样拖放。默认颜色组合为**设置>外观**里的颜色，也是全局默认颜色。 |
| **自定义文本** | 指定此时倒计时的内容的格式。 | 默认使用**全局自定义文本对话框**设置的文本，也是全局文本。有关占位符详见 [✨ 占位符一览](#-占位符一览)。 |
| **重置** | 重置颜色组合或自定义文本为全局默认颜色。 |  |

# 🎯 全局自定义文本对话框使用说明
## ✨ 选项说明
| **选项名称** | **功能说明** | **注意** |
| ----- | ---- | ---- |
| **考试未开始** | 表示`考试未开始`时倒计时要显示的内容格式 | 有关该阶段详见 [✨ 时间线说明](#-时间线说明)。 |
| **考试已开始** | 表示`考试已开始`时倒计时要显示的内容格式 | 有关该阶段详见 [✨ 时间线说明](#-时间线说明)。 |
| **考试已结束** | 表示`考试已结束`时倒计时要显示的内容格式 | 有关该阶段详见 [✨ 时间线说明](#-时间线说明)。 |
| **重置** | 一键重置上述所有自定义文本为初始值。 |  |

## ✨ 占位符一览
| **占位符** | **表示含义** |
| ----- | ---- |
| `{x}` | `eXamName` 考试名称。 |
| `{d}` | `Days` 天数。比如不足一天则为 `0`，不足两天为 `1`。 |
| `{h}` | `Hours` 小时。 |
| `{m}` | `Minutes` 分钟。 |
| `{s}` | `Seconds` 秒。 |
| `{cd}` | `CeilingDays` 天数向上取整。比如不足一天为 `1`，不足两天为 `2`。 |
| `{th}` | `TotalHours` 总小时。 |
| `{tm}` | `TotalMinutes` 总分钟。 |
| `{ts}` | `TotalSeconds` 总秒数。 |

| **一些例子** | **效果** |
| ----- | ---- |
| `距离{x}还有{d}.{h}:{m}:{s}` | `距离高考还有101.12:59:58` |
| `还有{cd}天就{x}了,还不快抓紧复习!` | `还有102天就高考了,还不快抓紧复习!` |
| `<更多玩法等你来发现>` |  |

# 🎯 意外错误对话框使用说明

> [!TIP]
> 用于显示程序运行过程中出现的意外错误，同时会在安装目录里的 `UnhandledException.txt` 文件中写入异常信息。此时应及时将错误信息/日志上报到此仓库 Issues 版块。

| **选项** | **功能说明** |
| ----- | ---- |
| 直接关闭对话框 | 忽略本次错误，并尝试继续运行程序。 |
| 是 | 重启程序。 |
| 否 | 退出程序。|

# 🎯 命令行选项

> [!TIP]
> 使用方法：右键单击倒计时窗口> 选择 `安装目录`> 然后退出倒计时> 在资源管理器地址栏输入 `cmd` 回车> 输入 `PlainCEETimer /?` 即可。

| **选项** | **功能说明** | **注意** |
| ----- | ---- | ---- |
| `/h` `/?` | 显示帮助信息。 |  |
| `/ac` | 检测当前用户是否具有管理员权限。 |  |
| `/fr <版本号>` | 强制下载并安装指定的版本，**留空**则当前版本，推荐在特殊情况下使用，不支持老版本。 | 这玩意儿在更新功能抽风的时候贼好用。比如使用 `PlainCEETimer.exe /fr` 强制下载并安装当前版本，使用 `/fr 3.0` 则下载 `3.0` 版本 (这里仅供演示，实际不能下载老版本)。 |

# 📄 致用户
+ 此高考倒计时程序是本人在 2023 年 (高二) 时应班级要求编写的，如有雷同，纯属巧合；
+ 软件目前所有功能均按照个人和老师及同学的要求开发，可能存在一些不足和瑕疵，还请各位用户多多谅解；
+ 本项目是我第一次 C# 实战，我会尽可能在不影响用户体验下把所学的全部知识都应用在这个项目中，所以可能会有一些屎山或冗余代码，欢迎各位对源代码进行批评和指点；
+ 欢迎各位用户在 GitHub [Issues](https://github.com/WangHaonie/PlainCEETimer/issues/new/choose) 或 [Discussions](https://github.com/WangHaonie/PlainCEETimer/discussions) 里分享您的观点和想法，虽然能力和时间有限，但我也会尽量去完成每一个用户提出的问题，感谢您的理解和支持！
