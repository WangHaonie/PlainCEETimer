<div align="center">
    <h1>PlainCEETimer 用户手册</h1>
    <h4>适用于 ~v5.0.6 | 修订日期 2025/8/5</h4>
</div>

# 📖 目录
- [⬇️ 下载安装](#️-下载安装)
    * [🛠️ 运行环境准备](#️-运行环境准备)
    * [🛠️ 安装高考倒计时](#️-安装高考倒计时)
    * [🛠️ 版本号说明](#️-版本号说明)
- [🎯 主窗口使用说明](#-主窗口使用说明)
    * [🎉 特性](#-特性)
    * [✨ 选项说明](#-选项说明)
- [🎯 托盘图标使用说明](#-托盘图标使用说明)
    * [🎉 特性](#-特性-1)
    * [✨ 选项说明](#-选项说明-1)
- [🎯 设置窗口使用说明](#-设置窗口使用说明)
    * [✨ 基本](#-基本)
    * [✨ 显示](#-显示)
    * [✨ 外观](#-外观)
    * [✨ 工具](#-工具)
- [🎯 关于窗口使用说明](#-关于窗口使用说明)
- [🎯 下载器窗口使用说明](#-下载器窗口使用说明)
    * [🎉 特性](#-特性-2)
    * [✨ 选项说明](#-选项说明-2)
- [🎯 考试信息管理器使用说明](#-考试信息管理器使用说明)
    * [🎉 特性](#-特性-3)
    * [✨ 选项说明](#-选项说明-3)
- [🎯 考试信息对话框使用说明](#-考试信息对话框使用说明)
- [🎯 规则管理器使用说明](#-规则管理器使用说明)
    * [🎉 特性](#-特性-4)
    * [✨ 选项说明](#-选项说明-4)
- [🎯 规则对话框使用说明](#-规则对话框使用说明)
    * [🎉 特性](#-特性-5)
    * [✨ 时间线说明](#-时间线说明)
    * [✨ 选项说明](#-选项说明-5)
- [🎯 全局自定义文本对话框使用说明](#-全局自定义文本对话框使用说明)
    * [✨ 选项说明](#-选项说明-6)
    * [✨ 占位符一览](#-占位符一览)
- [🎯 深色模式覆盖率一览](#-深色模式覆盖率一览)
- [🎯 命令输出对话框使用说明](#-命令输出对话框使用说明)
- [🎯 FileDialogWrapper 对话框使用说明](#-filedialogwrapper-对话框使用说明)
- [🎯 意外错误对话框使用说明](#-意外错误对话框使用说明)
- [🎯 命令行选项](#-命令行选项)
- [📣 常见错误](#-常见错误)
- [📄 致用户](#-致用户)

# ⬇️ 下载安装

> [!TIP]
> 本项目具有自动构建，若想使用自动构建版本 (相当于测试版)，请自行到 [Release](https://github.com/WangHaonie/PlainCEETimer/releases/tag/Preview) 下载。
> + **【注意事项】**
> + 自动构建版本的功能可能不稳定，不推荐作为长期使用
> + 自动构建版本的更新频率较高，且该渠道的版本不支持自动检查更新，需用户主动到此页面下载最新版本
> + 自动构建的版本号沿用上一个正式版的版本号，确保在下一个正式版发布时可以获取到更新

## 🛠️ 运行环境准备
+ **Windows 7 SP1 x64** 及以上；
+ **Microsoft Visual C++ 2015-2022 Redistributable x64**。大多数情况下系统中个别其它软件可能进行了安装，可以不用再次安装，若没有安装请到[官网](https://aka.ms/vs/17/release/vc_redist.x64.exe)下载或直接安装`微软常用运行库合集`；
+ **.NET Framework 4.8**。新版 Windows 10/11 自带，其他系统需自行下载 ([点此](https://dotnet.microsoft.com/zh-cn/download/dotnet-framework/thank-you/net48-offline-installer)进入)，并且可能需要预先安装相关系统更新及安全证书，请自行上网查询。

## 🛠️ 安装高考倒计时
+ 到 Release 页面下载 `PlainCEETimer...x64_Setup.exe`。[点此](https://github.com/WangHaonie/PlainCEETimer/releases/latest)进入；
+ 运行安装程序按提示进行；
+ 安装完成后会自动进行优化，以提升倒计时的启动速度，可能弹出 UAC 提示框，请点击 是；
+ 优化完成后将自动运行倒计时，倒计时的位置默认在主显示器顶部居中。

## 🛠️ 版本号说明

| 字段 | 说明 |
| ----- | ----- |
| 0 | 主版本号，但每次自增不一定代表有大更新，看心情 ( |
| .0 | 弃用，不会自增，用 0 占位。 |
| .0 | 自增表示该次更新包含修复或新功能。本项目几乎都采用这种更新方式。 |
| .0 | 自增表示维护性更新，该类型更新不会包含修复或新功能，仅代码层面上修改 (人话就是刷版本号)。有时会用于紧急更新。 |

> [!IMPORTANT]
> 本项目自首次提交以来差不多 2 年了，程序逐渐趋于完善，开发也几乎接近尾声，但应该不会完全停更。若无用户反馈的话后续更新可能都会采用上表第4种方式。

# 🎯 主窗口使用说明
## 🎉 特性
+ **边框圆角设计**：运行在 Windows 11 上将采用与系统一致的圆角设计，其他 Windows 上则使用 GDI 绘制圆角，会略带锯齿，但也能接受。
+ **防关闭**：防止使用常规方式关闭倒计时窗口。
+ **初次颜色自适应**：对于 Windows 10 1903 及以上的系统，倒计时在首次运行时的**文字/背景颜色**将跟随深/浅色主题使用黑/白底颜色组合。此特性会在用户点击一次设置的**保存**后失效，之后启动将不再自动跟随。
+ **初次默认字体**：倒计时在首次运行时，系统中若安装了 [`Noto Sans SC`](https://fonts.google.com/noto/specimen/Noto+Sans+SC)，则默认字体为 `Noto Sans SC`，否则为 `微软雅黑`。此特性会在用户点击一次设置的**保存**后失效，之后启动将不再自动检测默认字体。
+ **顶置行为**：顶置时不会在任务栏上显示图标，反之则会。

## ✨ 选项说明

> [!TIP]
> 右键单击主窗口即可显示快捷菜单。

| **选项名称** | **功能说明** | **注意** |
| ----- | ---- | ---- |
| **切换** | 本程序支持多倒计时，此选项可以快捷切换到相应的考试进行倒计时。 |  |
| **设置** | 打开 设置 窗口来配置倒计时。 | 详见 [🎯 设置窗口使用说明](#-设置窗口使用说明)。 |
| **关于** | 打开 关于 窗口查看有关本程序的信息以及一些有用的链接。 | 详见 [🎯 关于窗口使用说明](#-关于窗口使用说明)。 |
| **安装目录** | 打开本程序的安装文件夹。 |  |

# 🎯 托盘图标使用说明
## 🎉 特性
+ 当鼠标悬停在图标上时，可显示当前倒计时的内容。(默认关闭，需手动开启。且仅在 Windows 11 上支持**实时更新**。)
+ 直接左键单击托盘图标可实现右键菜单 **显示界面** 选项同样的效果。

## ✨ 选项说明

> [!TIP]
> 右键单击托盘图标即可显示快捷菜单。

| **选项名称** | **功能说明** | **注意** |
| ----- | ---- | ---- |
| **设置** | 打开 设置 窗口来配置倒计时。 | 详见 [🎯 设置窗口使用说明](#-设置窗口使用说明)。 |
| **关于** | 打开 关于 窗口查看有关本程序的信息以及一些有用的链接。 | 详见 [🎯 关于窗口使用说明](#-关于窗口使用说明)。 |
| **安装目录** | 打开本程序的安装文件夹。 |  |
| **显示界面** | 点击后将显示本程序已打开的窗口。 |  |
| **关闭** | 可在此快速 **重启/退出** 倒计时 | 在 **设置>工具** 里也有相应功能。 |

# 🎯 设置窗口使用说明
## ✨ 基本
| **选项名称** | **功能说明** | **注意** |
| ----- | ---- | ---- |
| **管理** | 用于存储并管理考试信息以支持多倒计时功能。 | 详见 [🎯 考试信息管理器使用说明](#-考试信息管理器使用说明)。 |
| **启用自动切换** | 当存在2个及以上的考试信息时，可启用自动切换功能轮流对各考试进行倒计时。切换间隔可在旁边的下拉菜单中选择。 |  |
| **应用主题设定** | 用于更改除倒计时以外的窗口 UI 主题。可选 跟随系统/浅色/深色。 | 详见 [🎯 深色模式覆盖率一览](#-深色模式覆盖率一览)。仅支持 Windows 10 1903 及以上并且关闭了高对比度主题。`跟随系统`并不支持在运行时随系统主题的切换而切换，需手动重启倒计时。 |
| **开机时自动运行倒计时** | 设置倒计时开机启动 (注册表)。 | 在**未勾选情况**下进行勾选的同时按下 `Shift` 可以切换为由任务计划程序来启动倒计时 (此时会标注`*`符号)，这在大多数情况下可以达到开机提前启动 (相对于注册表启动方式) 倒计时的效果。 |
| **自动清理倒计时占用的运行内存** | 开启后，将每隔5分钟清理倒计时运行内存占用。 | 仅当内存占用超过 `9 MB` 才会触发清理。 |
| **顶置倒计时窗口** | 是否顶置倒计时窗口。 |  |
| **顶置其他窗口** | 是否顶置本程序除倒计时以外的窗口，比如 设置、关于、对话框 等。 | 只有勾选了 **顶置倒计时窗口** 才能更改此选项。 |
| **在托盘区域显示通知图标** | 是否在任务栏托盘区域显示程序图标。 |  |
| **鼠标悬停在通知图标上时显示倒计时内容** | 开启后，并且倒计时正常进行，将在托盘图标的描述文本中实时显示倒计时内容。 |  |

## ✨ 显示
| **选项名称** | **功能说明** | **注意** |
| ----- | ---- | ---- |
| **当考试开始后, 显示...** | 可选显示 **考试还有多久结束** 以及 **考试已经过去了多久** | 本程序的~~特色功能，或许没用~~。因为在开发时想到当考试开始后倒计时似乎就没有什么可以显示的了，显得有些单调，所以添加了该功能。 |
| **只显示...** | 可选是否只显示**天/时/分/秒**等 | 与 **自定义不同时刻的颜色和内容** 选项冲突，二者只能开启之一 |
| **不足一天按整天计算** | 用于达到纸质倒计时的效果，开启后倒计时会将不足一天的时间按整天计算 | 只有当 **只显示...** 设置为 **天** 的时候才能更改此选项。 |
| **自定义不同时刻的颜色和内容** + **规则管理器** | 高度自定义各个时刻倒计时要显示的内容格式、颜色等。比如还有100天时显示为紫色。 | 详见 [🎯 规则管理器使用说明](#-规则管理器使用说明)。与 **只显示...** 选项冲突，二者只能开启之一。 |
| **固定在屏幕...** | 用于将倒计时窗口固定在指定的屏幕上。 | 此项与 **允许拖动倒计时窗口** 选项冲突，二者只能开启之一。描述显示器的字符串格式为 `<序号>. <名称> <型号> (<路径>) (<分辨率>)`。<br>**序号**：系统显示设置中定义的显示器顺序；<br>**名称**：的话会因厂家设定不同，有时其中可能已经包含了型号 (SKU)，有时只是品牌名，极端情况下甚至无法获取到该字段 (比如大多数笔记本电脑)，此时可参考**型号**字段；<br>**型号**：在此处通常获取到的是显示器的**面板型号**，而不是面向消费者的型号 (SKU)，该字段前3个大写字母 (若有的话) 一般表示面板的品牌的代号，由于从代号转译为完整品牌名需要建立数据库，较为繁琐，故本程序未包含此功能，不过可以到 [PNP ID Registry](https://uefi.org/PNP_ID_List) 查询；<br>**路径**：显示器的 **DOS 设备路径** (比如 `\\.\DISPLAY1`)，路径最后的那个数字一般表示显示器在显卡上的连接顺序。 |
| **位置...** | 用于将倒计时窗口固定在指定屏幕上的9个特殊位置。 | 与 **允许拖动倒计时窗口** 选项冲突，二者只能开启之一。 |
| **允许拖动倒计时窗口** | 开启后可以随心所欲的拖动倒计时窗口 | 与 **固定在屏幕...位置...** 选项冲突，二者只能开启之一。 |
| **兼容希沃PPT小工具** | 用于避免希沃PPT小工具内置白板打开后底部工具栏消失的情况。 | 仅个别机型存在，并只有倒计时恰好在左上角且顶置才会出现该问题。 |

## ✨ 外观
| **选项名称** | **功能说明** | **注意** |
| ----- | ---- | ---- |
| **字体和大小** | 更改倒计时字体和大小 以及 恢复默认字体和大小。 | 字体推荐使用 `微软雅黑` 或 [`Noto Sans SC`](https://fonts.google.com/noto/specimen/Noto+Sans+SC)，大小为 `10`~`36`pt。 |
| **恢复默认** | 将字体恢复为默认。 | 若系统安装了有 [`Noto Sans SC`](https://fonts.google.com/noto/specimen/Noto+Sans+SC) 则将其作为默认字体。 |
| **字体颜色** | 直接点击相应色块来选择文字、背景颜色 以及 恢复默认颜色组合，并可选黑底或白底。 | 将一个色块拖放到其它色块上可快速应用相同的颜色；将准心拖出本窗口范围可以选取屏幕上的颜色。<br>**关于取色器**：由于众所周知的原因，取色器最终取样的像素点大致为准心右下角的第一个像素而非准心所在的像素，请仔细甄别。<br>若启用了`自定义不同时刻的颜色和内容`，此处的颜色将用于匹配规则之外作为全局默认颜色。 |
| **恢复默认** | 将所有/指定的颜色组合重置为默认的白底/黑底。 |  |

## ✨ 工具
| **选项名称** | **功能说明** | **注意** |
| ----- | ---- | ---- |
| **同步网络时钟** | 选择给定的 NTP 服务器并与之同步时钟。 | 将设置为系统默认 NTP 服务器且自动启动 Windows Time 服务。需要**管理员权限**，若无将弹出授权提示。 |
| **重启倒计时** | 主要用于更改了屏幕缩放之后, 可以点击此按钮来重启程序以确保 UI 正常显示。 | 由于难以支持 `Per-Monitor V2`，需手动重启才能避免模糊。 |
| **关闭倒计时** | 退出倒计时 | `鼠标右键`单击 **重启倒计时** 触发。 |
| **命令行模式** | 进入命令行模式 (`cmd`) | `Ctrl` + `鼠标左键`单击 **重启倒计时** 触发。可用命令行参数详见 [🎯 命令行选项](#-命令行选项)。 |

# 🎯 关于窗口使用说明
| **选项名称** | **功能说明** | **注意** |
| ----- | ---- | ---- |
| **程序 Logo** | 手动检查更新。 | 检查更新功能为强制启用机制，无法控制其开关。 |
| **链接** | 点击相应链接跳转到相应的页面。 |  |

# 🎯 下载器窗口使用说明

> [!TIP]
> 用于下载更新程序。打开途径：有更新时用于确认后会弹出下载器窗口；使用命令行参数 `/fr` 强行运行下载器 (详见 [🎯 命令行选项](#-命令行选项))。

## 🎉 特性
+ 除了在界面中显示实时下载进度/大小/速度等之外，在任务栏图标上也会显示进度条。

## ✨ 选项说明
| **选项名称** | **功能说明** |
| ----- | ---- |
| **浏览器下载** | 跳转到浏览器并使用浏览器手动下载安装程序。 |
| **重试** | 下载出错时可以重新启动下载。 |

# 🎯 考试信息管理器使用说明

> [!TIP]
> 通过 `设置>基本: 管理` 打开。

> [!IMPORTANT]
> 有关**考试信息对话框**的使用，请见 [🎯 考试信息对话框使用说明](#-考试信息对话框使用说明)。

## 🎉 特性
+ 自动分组：将考试开始/结束日期时间与当前对比，分为 "已过去的"、"正在进行"、"未开始的"。不允许用户自定义分组。
+ 自动排序：先按考试的**开始时间**进行升序 (早到晚) 排列，再按考试的**结束时间**进行升序 (早到晚) 排列，最后按**考试名称**进行升序 (码点从小到大，不是拼音) 排列。不允许用户自定义顺序。
+ 重复项判断依据：两个考试信息的`考试名称`、`开始日期时间`、`结束日期时间`相等。
+ 内容超出列表视图范围时将鼠标悬停到项目上将以工具提示 (ToolTip) 展示对应内容。
+ **重复**：选中一个考试信息后按下 `Ctrl`+`C` 来重复选中的考试信息
+ **编辑**：**左键双击**现有考试信息可快速打开考试信息对话框。
+ **删除**：按下 `Delete` 键即可实现删除。
+ **全选**：按下 `Ctrl`+`A` 组合键即可实现全选。支持不连续多选 (**原生特性**，按住 `Ctrl` 同时 `鼠标左键` 单击考试信息)。

## ✨ 选项说明
| **选项名称** | **功能说明** | **注意** |
| ----- | ---- | ---- |
| **列表** | 展示考试信息。 | 右键单击表格打开快捷菜单进行相关操作。 |
| **操作** | 在当前位置显示表格的快捷菜单。 | 适用于无法右键单击表格打开菜单的特殊情况，而左键单击此按钮就可以显示菜单。 |
| **添加** | 添加新的考试信息。 | 详见 [🎯 考试信息对话框使用说明](#-考试信息对话框使用说明)。 |
| **重复** | 以当前考试信息为默认以方便修改进行新的添加操作。 | 相当于复制，但不允许重复。 |
| **编辑** | 编辑当前选中的考试信息。 | 只能选中一个，不能同时编辑多个考试信息。详见 [🎯 考试信息对话框使用说明](#-考试信息对话框使用说明)。 |
| **删除** | 删除当前选中的考试信息。 | 支持多选。 |
| **全选** | 全选所有的考试信息。 |  |

# 🎯 考试信息对话框使用说明

> [!TIP]
> 日期时间挑选器使用说明
> + 如何设置日期？
>   + 【**方法一**】点击右侧日历图标，展开后可在日历中选择。
>   + 【**方法二**】直接点击控件里的数字 (对应 年月日)，然后输入即可。上下箭头可以进行自增/减，左右箭头切换输入区域。比如要设置 `2025年6月7日`，先点击年对应的数字，输入 `2025` 后按下右箭头输入 `6`，然后按下右箭头输入 `7` 即可。
> + 如何设置时间？
>   + 同上述设置日期的**方法二**。

| **选项名称** | **功能说明** | **注意** |
| ----- | ---- | ---- |
| **考试名称** | 输入考试的名称。 | `2`~`10`字。 |
| **开始日期和时间** | 选择/输入考试的开始日期和时间。 | 方法详见上方 Tip |
| **结束日期和时间** | 选择/输入考试的结束日期和时间。 | 方法详见上方 Tip |

# 🎯 规则管理器使用说明

> [!TIP]
> 通过 `设置>显示: 勾选 "自定义不同时刻的颜色和内容" 后点击 "规则管理器"` 打开。

> [!IMPORTANT]
> 有关**规则对话框**的使用，请见 [🎯 规则对话框使用说明](#-规则对话框使用说明)。
> 有关**全局自定义文本对话框**的使用，请见 [🎯 全局自定义文本对话框使用说明](#-全局自定义文本对话框使用说明)。

## 🎉 特性
+ 自动分组：直接按规则的**类别**分为 "开始还有"、"结束还有"、"已过去了"。不允许用户自定义分组。
+ 自动排序：类别为 "开始还有"、"结束还有" 的按时刻**降序**排列；类别为 "已过去了" 的按时刻**升序**排列。不允许用户自定义顺序。
+ 重复项判断依据：两个规则的`类别`和`时刻`相等。
+ 规则在列表中的排列顺序即为倒计时在运行时的匹配顺序。
+ 内容超出列表视图范围时将鼠标悬停到项目上将以工具提示 (ToolTip) 展示对应内容。
+ **重复**：选中一个自定义规则后按下 `Ctrl`+`C` 来重复选中的自定义规则
+ **编辑**：**左键双击**现有规则可快速打开规则对话框。
+ **删除**：按下 `Delete` 键即可实现删除。
+ **全选**：按下 `Ctrl`+`A` 组合键即可实现全选。单击分组标题可以全选同一个类别下的规则 (**原生特性**)。支持不连续多选 (**原生特性**，按住 `Ctrl` 同时 `鼠标左键` 单击规则)。

## ✨ 选项说明
| **选项名称** | **功能说明** | **注意** |
| ----- | ---- | ---- |
| **列表** | 展示自定义规则。 | 右键单击表格打开快捷菜单进行相关操作。 |
| **操作** | 在当前位置显示表格的快捷菜单。 | 适用于无法右键单击表格打开菜单的特殊情况，而左键单击此按钮就可以显示菜单。 |
| **添加** | 添加新的规则。 | 详见 [🎯 规则对话框使用说明](#-规则对话框使用说明)。 |
| **重复** | 以当前自定义规则为默认以方便修改进行新的添加操作。 | 相当于复制，但不允许重复。 |
| **编辑** | 编辑当前选中的规则。 | 只能选中一个，不能同时编辑多个规则。详见 [🎯 规则对话框使用说明](#-规则对话框使用说明)。 |
| **删除** | 删除当前选中的规则。 | 支持多选。 |
| **全选** | 全选所有的规则。 |  |
| **全局设置** | 打开**全局自定义文本对话框**，用于存放规则之外倒计时要显示的内容。 | 详见 [🎯 全局自定义文本对话框使用说明](#-全局自定义文本对话框使用说明)。 |

# 🎯 规则对话框使用说明
## 🎉 特性
+ 在**添加**模式下，对话框会缓存用户临时设置的三个阶段 (详见 [✨ 时间线说明](#-时间线说明)) 的相关信息以便翻阅。

## ✨ 时间线说明
以下简易图表表示了本程序各场景对于一场考试三个阶段的描述性文本。
```
    未开始                已开始                 已结束      // 全局自定义文本对话框
  距离开始还有           距离结束还有           距离已过去了   // 规则对话框的下拉列表
-------------->考试开始-------------->考试结束------------->
    第一阶段              第二阶段               第三阶段     // 可以分为三个阶段
```

## ✨ 选项说明
| **选项名称** | **功能说明** | **注意** |
| ----- | ---- | ---- |
| **当距离考试...** | 选择规则要匹配的阶段。 | 有关各阶段，详见 [✨ 时间线说明](#-时间线说明)。 |
| **...天...时...分...秒** | 在指定的时间匹配该规则。 | 最少`1`秒，不能全为`0`。可以通过键盘上下箭头来对值进行自增/减。 |
| **文字颜色为...背景颜色为...** | 指定在此时要显示的文字/背景颜色。 | 点击色块选择颜色，不支持像**设置**里那样拖放。默认颜色组合为**设置>外观**里的颜色，也是全局默认颜色。 |
| **自定义文本** | 指定此时倒计时的内容的格式。 | 默认使用**全局自定义文本对话框**设置的文本，也是全局文本。有关占位符详见 [✨ 占位符一览](#-占位符一览)。 |
| **重置** | 重置颜色组合或自定义文本为全局默认颜色。 |  |

# 🎯 全局自定义文本对话框使用说明
## ✨ 选项说明
| **选项名称** | **功能说明** | **注意** |
| ----- | ---- | ---- |
| **考试未开始** | 表示`考试未开始`时倒计时要显示的内容格式 | 有关该阶段详见 [✨ 时间线说明](#-时间线说明)。 |
| **考试已开始** | 表示`考试已开始`时倒计时要显示的内容格式 | 有关该阶段详见 [✨ 时间线说明](#-时间线说明)。 |
| **考试已结束** | 表示`考试已结束`时倒计时要显示的内容格式 | 有关该阶段详见 [✨ 时间线说明](#-时间线说明)。 |
| **重置** | 重置所有/指定的自定义文本为初始值。 |  |

## ✨ 占位符一览
| **占位符** | **全称** | **表示含义** |
| ----- | ---- | ---- |
| `{x}` | `eXamName` | 考试名称。 |
| `{d}` | `Days` | 天数。比如不足一天则为 `0`，不足两天为 `1`。 |
| `{h}` | `Hours` | 小时。 |
| `{m}` | `Minutes` | 分钟。 |
| `{s}` | `Seconds` | 秒。 |
| `{cd}` | `CeilingDays` | 天数向上取整。比如不足一天为 `1`，不足两天为 `2`。 |
| `{th}` | `TotalHours` | 总小时。 |
| `{tm}` | `TotalMinutes` | 总分钟。 |
| `{ts}` | `TotalSeconds` | 总秒数。 |

| **一些例子** | **效果** |
| ----- | ---- |
| `距离{x}还有{d}:{h}:{m}:{s}` | `距离高考还有101:12:59:58` |
| `还有{cd}天就{x}了,还不快抓紧复习!` | `还有102天就高考了,还不快抓紧复习!` |
| `<更多玩法等你来发现>` |  |

# 🎯 深色模式覆盖率一览
| **对话框** | **名称** | **覆盖率** | **无法深色的控件** |
| ----- | ---- | ---- | ---- |
| 快捷菜单 | ContextMenu | `100%` |  |
| 主窗口 | MainForm | `100%` |  |
| 设置 | SettingsForm | `100%` |  |
| 关于 | AboutForm | `100%` |  |
| 消息框 | AppMessageBox | `100%` |  |
| 命令输出对话框 | ConsoleWindow | `100%` |  |
| 规则对话框 | RuleDialog | `100%` | `*1` |
| 全局自定义文本 | CustomTextDialog | `100%` |  |
| 考试信息管理器 | ExamInfoManager | `100%` |  |
| 规则管理器 | RulesManager | `100%` |  |
| 颜色对话框 | PlainColorDialog | `90%`~`100%` | `*2` |
| 下载器 | DownloaderForm | `85%` | ProgressBar, HyperLink (Disabled) |
| 考试信息对话框 | ExamInfoDialog | `80%` | DateTimePicker |
| 字体对话框 | PlainFontDialog | `75%` | ComboBox |
| 系统消息框 | MessageBox | `0%` |  |

> [!NOTE]
> `*1` 在 Windows 10 上，NumericUpDown 控件的 UpDown 按钮没有深色主题为正常现象。<br>
> `*2` 色块选过后会出现白边，亮度三角形滑块能见度低 (可以使用滑条)。

# 🎯 命令输出对话框使用说明

> [!IMPORTANT]
> 由于 Windows 系统 ShellExecute 机制的限制，在非管理员下运行相关命令时，无法通过常规的方式实时获取提权后的输出。本程序采用的方式也勉强够用，因此偶尔出现的排版错误是正常情况。不过在管理员账户下不易出现此问题。

用于实时显示一些外部命令的输出，右键输出框可以全选/复制内容。

# 🎯 FileDialogWrapper 对话框使用说明

用于向用户展示 保存/选择文件对话框。

由于直接显示此类对话框不会在任务栏上显示图标，故将 FileDialogWrapper 作为中间者来显示对话框，可以在任务栏上显示图标。方便用户无意间隐藏文件对话框后，可以点击任务栏图标来快速恢复对话框显示。

# 🎯 意外错误对话框使用说明

> [!TIP]
> 用于显示程序运行过程中出现的意外错误，同时会在安装目录里的 `UnhandledException_*.txt` 文件中写入异常信息。此时应及时将错误信息上报到此仓库 Issues 版块。

| **选项** | **功能说明** |
| ----- | ---- |
| `中止` | 退出程序。 |
| `重试` | 重启程序。 |
| `忽略` | 忽略本次错误，并尝试继续运行程序。|

# 🎯 命令行选项

> [!TIP]
> 进入方法：在 **设置>工具>** 中 `Ctrl` + `鼠标左键`单击 **重启倒计时** 按钮。

| **选项** | **功能说明** | **注意** |
| ----- | ---- | ---- |
| `/h` `/?` | 显示帮助信息。 |  |
| `/ac` | 检测当前用户是否具有管理员权限。 |  |
| `/fr [版本号]` | 强制下载并安装指定的版本，**留空**则当前版本，推荐在特殊情况下使用，不支持老版本。 | 这玩意儿在更新功能抽风的时候贼好用。比如使用 `PlainCEETimer.exe /fr` 强制下载并安装当前版本，使用 `/fr 3.0` 则下载 `3.0` 版本 (这里仅供演示，实际不能下载老版本)。 |
| `/op` | 优化程序运行速度。 | 提升一定的运行速度。推荐在以下情况下使用：首次运行本程序、清理过系统垃圾 (特别是 .NET 缓存) 之后、其他情况导致的肉眼明显感知到程序运行速度变慢。 |
| `/lnk [/custom]` | 向开始菜单文件夹和桌面创建指向本程序的快捷方式，若加上 `/custom` 表示用户将自行选择保存快捷方式的文件夹。 | 可用于某些情况快速恢复程序的快捷方式。 |

# 📣 常见错误
## PlainCEETimer.exe 已停止运行
+ 未安装 .NET Framework 4.8 或更高版本，请参见 [🛠️ 运行环境准备](#️-运行环境准备)。
+ 相关组件丢失，比如 (`Newtonsoft.Json.dll`、`PlainCEETimer.Natives.dll` 等)
## PlainCEETimer.Interop.ThemeManager 的类型初始值设定项引发异常
+ 未安装 Microsoft Visual C++ 2015-2022 Redistributable x64 运行库，详见 [🛠️ 运行环境准备](#️-运行环境准备)。
+ `Newtonsoft.Json.dll` 丢失。
## 双击打开后无界面显示且疑似闪退等异常且未弹出意外错误对话框
+ `PlainCEETimer.Natives.dll` 丢失，请重新安装。
+ 程序内部出错，请运行 `eventvwr.msc` 定位到 `Windows 日志` >`应用程序` 找到当时来源为 `.NET Runtime` 或 `Application Error` 的**错误**消息，点击下方的**详细信息**选项卡，复制所有日志内容，然后上报到 [Issues](https://github.com/WangHaonie/PlainCEETimer/issues/new/choose)。
## 无法设置/取消开机启动 或 "系统环境异常，..."
请不要在不同的用户会话中运行本程序。原因最可能是用户使用 **账户1** 登入系统，却以 **账户2** 的身份运行本程序。比如在普通账户里运行本程序时选择了 以管理员身份运行。此时应用程序将无法获取当前登入用户的文件夹/注册表等 (获取到的是提权用户的，不是预期结果)，因此要保持在同一会话中运行本程序，即直接双击运行。
## "提权失败 当前系统已禁用 UAC"
请使用**管理员账户**登录系统，在开始菜单 (`Win`+`S`) 搜索 `uac` 并打开，将滑块拖动至第二阶：`默认 - 仅在程序尝试对我的计算机进行更改时通知我` 点击`确定`后重启电脑。

# 📄 致用户
+ 此高考倒计时程序是本人在 2023 年时应班级要求编写的，如有雷同，纯属巧合；
+ 软件目前所有功能均按照个人和老师及同学的要求开发，可能存在一些不足和瑕疵，还请各位用户多多谅解；
+ 本项目是我第一个项目，我会尽可能在不影响用户体验下把所学的全部知识都应用在这个项目中，所以可能会有一些屎山或冗余代码，欢迎各位对源代码进行批评和指点；
+ 欢迎各位用户在 GitHub [Issues](https://github.com/WangHaonie/PlainCEETimer/issues/new/choose) 或 [Discussions](https://github.com/WangHaonie/PlainCEETimer/discussions) 里分享您的观点和想法，虽然能力和时间有限，但我也会尽量去完成每一个用户提出的问题，感谢您的理解和支持！
